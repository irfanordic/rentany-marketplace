<!DOCTYPE html>
<html>
  <head>
    <title>Circular Community</title>
    <style></style>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    {{> user-header}}
    <main class="page-container">
            {{{body}}}
        </main>
    
    
    
    <script>
        // Initialize socket
        const socket = io();
    
        // 1. Identify User (Using a cleaner check to avoid Parse Errors)
        const currentUserId = "{{user._id}}"; 
        
        if (currentUserId && currentUserId !== "") {
            socket.emit('join', currentUserId);
        }
    
        // 2. Listen for Incoming Pings
        socket.on('get-notification', (data) => {
          const Toast = Swal.mixin({
                      toast: true,
                      position: 'top-end',
                      showConfirmButton: false,
                      timer: 4000,
                      timerProgressBar: true,
                      background: '#4f46e5', // Indigo
                      color: '#ffffff'
                  });
                  Toast.fire({
                      icon: 'info',
                      title: 'New Rental Request!',
                      text: data.message
                  });
        });
    
        // 3. Function to trigger the notification
        function notifyOwner(ownerId, productName) {
            socket.emit('send-notification', {
                ownerId: ownerId,
                productName: productName,
                userName: "{{user.Name}}"
            });
        }
    
        socket.on('display-response', (data) => {
         const isApproved = data.status === 'approved';
                 
                 Swal.fire({
                     title: isApproved ? 'Accepted!' : 'Declined',
                     text: data.message,
                     icon: isApproved ? 'success' : 'error',
                     confirmButtonColor: '#6366f1',
                     background: '#ffffff',
                     borderRadius: '20px'
                 });
        })
    
       
    </script>
     </body>
</html>
<style>
    /* This prevents the body from centering the NAV along with the content */
    body {
        display: block !important; /* Overrides the flex centering on body */
        margin: 0;
        padding: 0;
        overflow-x: hidden;
    }
    
    /* This container handles the centering of your cards instead of the body */
    .page-container {
        padding-top: 100px; /* Space for the navbar */
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column; /* Stack things vertically */
    }
</style>